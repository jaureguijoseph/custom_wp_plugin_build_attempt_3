## Harden servers before going live  **Harden Your WordPress Site**

**Caution**

The following recommendations are for server administrators with
knowledge of how these files work. If you do not feel comfortable with
these suggestions, we recommend using a [**[website firewall that
includes virtual
hardening]{.underline}**](https://blog.sucuri.net/2022/09/a-guide-to-virtual-patching-for-website-vulnerabilities.html) instead.

**4.1 Secure .htacccess Configurations**

The .htaccess file is what most vendors will modify when they say they
are hardening your WordPress environment.

This critical configuration file is specific for web servers running on
Apache. If you're running your WordPress instance on a LAMP stack using
Apache, then we recommend hardening your site by updating your .htaccess
file with the following rules.

**Note**

Some of the rules below are dependent on the version of Apache you are
running. In those cases, we have included instructions for both versions
2.2 and 2.4 of Apache Server.

**/.HTACCESS**

**Rule Explanation**

\# BEGIN WordPress

\# Rewrite rule

\<IfModule mod_rewrite.c\>

RewriteEngine On

RewriteBase /

RewriteRule \^index\\.php\$ -- \[L\]

RewriteCond %{REQUEST_FILENAME} !-f

RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule . /index.php \[L\]

\</IfModule\>

\# END WordPress

**Rewrite Rule:**

This rule is generated by WordPress if it has write access to your
server, most notably to fix issues with pretty permalinks.

If it isn't at the top of your file, place at the top of your .htaccess
file. Any other rules should go after the \# BEGIN WordPress and \# END
WordPress statements.

\# Block IPs for login Apache 2.2

\<files /wp-login.php\>

order deny, allow

allow from MYIP

allow from MYIPIP2

deny from all

\</files\>

\# Block IPS for login Apache 2.4

\<Files "wp-login.php"\>

Require all denied

\</Files\>

**Restrict Logins to IP Range**

This rule restricts access to wp-login.php to an IP, protecting you from
unauthorized login attempts in other locations. Even if you do not have
a static IP, you can still restrict logins to your ISP common range.

\<FilesMatch \"wp-config\\.php\"\>

Require all denied

\</FilesMatch\"\>

**Protect wp-config.php**

This rule restricts visitors from accessing your wp-config.php file,
which contains sensitive database information, including name, host,
username and password. It also defines advanced settings, security keys
and developer options.

\# Prevent directory browsing

Options All -Indexes

**Prevent Directory Browsing**

This rule prevents attackers from viewing the folder contents of your
website, restricting the information they have to exploit your website.

\# Prevent image hotlinking

RewriteEngine on

RewriteCond %{HTTP_REFERER} !\^\$

RewriteCond %{HTTP_REFERER} \\

!\^http://(www\\.)example.com/.\*\$ \[NC\]

RewriteRule \\.(gif\|jpg\|jpeg\|bmp\|png)\$ -- \[NC,F,L\]

**Prevent Image Hotlinking**

This rule prevents other websites from using images hosted on your
website. While hotlinking won't get your site hacked, it can result in a
damaging exploitation of your server resources. Change example.com to
your website.

\# Protect htaccess Apache 2.2

\<files \~ "\^.\*\\.(\[Hh\]\[Tt\]\[Aa\])"\>

order allow, deny

deny from all

satisfy all

\</files\>

\# Protect htaccess Apache 2.4

\<FilesMatch "\^.\*\\.(\[Hh\]\[Tt\]\[Aa\])"\>

Require all denied

\</FilesMatch\>

**Protect .htaccess**

This rule prevents attackers from accessing any files that start with
"hta" -- this ensures that .htaccess files are protected in all of the
directories of your server.

\# Block Includes

\<IfModule mod_rewrite.c\>

RewriteEngine On

RewriteBase /

RewriteRule \^wp-admin/includes/ -- \[F,L\]

RewriteRule !\^wp-includes/ -- \[S=3\]

RewriteRule \^wp-includes/\[\^/\]+\\.php\$ -- \[F,L\]

RewriteRule \^wp-includes/js/tinymce/langs/.+\\.php \\

-- \[F,L\]

RewriteRule \^wp-includes/theme-compat/ -- \[F,L\]

\</IfModule\>

**Block Includes**

This rule blocks hackers from inserting malicious files into any of the
four primary folders used for includes:

/wp-admin/includes/\
/wp-includes\
/wp-includes/js/tinymce/langs/\
/wp-includes/theme-compat/

If you run a multisite instance of WordPress, these directives may cause
issues. Always test and use caution.

**/WP-INCLUDES/.HTACCESS &\
\
/WP-CONTENT/UPLOADS/.HTACCESS**

**Rule Explanation**

\# Backdoor Protection Apache 2.2

\<Files \*.php\>

deny from all

\</Files\>

\# Backdoor Protection Apache 2.4

\<FilesMatch ".+\\.php\$"\>

Require all denied

\</FilesMatch\>

**Prevent PHP Backdoors**

This rule prevents hackers from placing PHP backdoors in
the **/wp-includes/** and **/wp-content/uploads/** folders, two popular
locations for malicious file uploads.
